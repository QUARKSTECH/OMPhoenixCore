<section class="contact-info section-padding">
  <div class="container">
    <div class="row">
      <div class="col-sm-12 marginbtm">
        <img
          class="img-responsive"
          src="../../assets/img/page-title-bg.jpg"
          alt=""
        />
        <div class="centered">
          <h1>{{ authService.decodedToken?.given_name }}</h1>
        </div>
      </div>
      <div class="col-sm-6">
        <!-- support info -->
        <div class="contact-info-content">
          <h2>Service request</h2>

          <div class="footer-widgets address-wid con-info marginbtm2">
            <div class="form-group">
              <label class="radio-inline">
                <input
                  class="mr-3"
                  type="radio"
                  [value]="true"
                  name="servicetype"
                  [(ngModel)]="requestModel.serviceType"
                />General Service
              </label>
              <label class="radio-inline ml-3">
                <input
                  class="mr-3"
                  type="radio"
                  [value]="false"
                  name="servicetype"
                  [(ngModel)]="requestModel.serviceType"
                />Breakdown Service
              </label>
            </div>
            <button
              type="button"
              name="submit"
              class="sent-button arina-btn hvr-radial-out"
              (click)="request('ServiceRequest')"
            >
              Create
            </button>
          </div>
          <h2>Material Request</h2>
          <div class="footer-widgets address-wid con-info marginbtm2">
            <div class="row">
              <div class="col-sm-6 col-md-6">
                <div class="form-content">
                  <input
                    name="partnumber"
                    placeholder="Part number"
                    class="form-control"
                    required=""
                    type="text"
                    [(ngModel)]="requestModel.PartNumber"
                  />
                </div>
              </div>
              <div class="col-sm-6 col-md-6">
                <div class="form-content">
                  <input
                    name="machinemodel"
                    placeholder="Machine model"
                    class="form-control"
                    required=""
                    type="text"
                    [(ngModel)]="requestModel.MachineModel"
                  />
                </div>
              </div>
            </div>
            <button
              type="button"
              name="submit"
              class="sent-button arina-btn hvr-radial-out"
              (click)="request('MaterialRequest')"
            >
              Create
            </button>
          </div>
          <h2>Service Job Cards</h2>
          <div class="footer-widgets address-wid con-info">
            <div class="row">
              <div class="col-sm-12 col-md-12">
                <div>
                  <table
                    class="table table-striped"
                    [mfData]="jobCard"
                    #jobcardTable="mfDataTable"
                    [mfRowsOnPage]="5"
                  >
                    <thead>
                      <tr>
                        <th style="width: 30%">
                          <mfDefaultSorter by="email">JobCard</mfDefaultSorter>
                        </th>
                        <th style="width: 20%">
                            <mfDefaultSorter by="name">MachineId</mfDefaultSorter>
                          </th>
                        <th style="width: 20%">
                          <mfDefaultSorter by="name">Month</mfDefaultSorter>
                        </th>

                        <th style="width: 20%">
                          <mfDefaultSorter by="age">View</mfDefaultSorter>
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let item of jobcardTable.data">
                        <td>{{ item.id }}</td>
                        <td>{{ item.machineId }}</td>
                        <td>{{ item.createdDate | date }}</td>
                        <td><a href="{{item.url}}" target="_blank"><i class="fa fa-eye"></i></a></td>
                      </tr>
                    </tbody>
                    <tfoot>
                      <tr>
                        <td colspan="4">
                          <mfBootstrapPaginator
                            [rowsOnPageSet]="[5, 10, 25]"
                          ></mfBootstrapPaginator>
                        </td>
                      </tr>
                    </tfoot>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-sm-6">
        <!-- contact form content -->
        <div class="contact-form-area">
          <h2>Add machine</h2>
          <!-- contact form -->
          <div class="contact-form" id="contentMachine">
            <form #machineForm="ngForm" (ngSubmit)="addMachine()">
              <div class="row">
                <div class="col-sm-6 col-md-6">
                  <div class="form-content">
                    <input
                      name="contactNo"
                      placeholder="Contact number"
                      class="form-control"
                      required=""
                      type="text"
                      [(ngModel)]="machine.contactNumber"
                    />
                  </div>
                </div>
                <div class="col-sm-6 col-md-6">
                  <div class="form-content">
                    <input
                      name="serialNo"
                      placeholder="Machine Serial No."
                      class="form-control"
                      required=""
                      type="text"
                      [(ngModel)]="machine.machineSerialNo"
                    />
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-6 col-md-6">
                  <div class="form-content">
                    <input
                      name="make"
                      placeholder="Machine make"
                      class="form-control"
                      required=""
                      type="text"
                      [(ngModel)]="machine.machineMake"
                    />
                  </div>
                </div>
                <div class="col-sm-6 col-md-6">
                  <div class="form-content">
                    <input
                      name="model"
                      placeholder="Machine model"
                      class="form-control"
                      required=""
                      type="text"
                      [(ngModel)]="machine.machineModel"
                    />
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-6 col-md-6">
                  <div class="form-content">
                    <input
                      name="runningHours"
                      placeholder="Current running hours"
                      class="form-control"
                      required=""
                      type="text"
                      [(ngModel)]="machine.currentRunningHours"
                      [readonly]="isEditMode"
                    />
                  </div>
                </div>
                <div class="col-sm-6 col-md-6">
                  <div class="form-content">
                    <input
                      name="loadingHours"
                      placeholder="Current loading hours"
                      class="form-control"
                      required=""
                      type="text"
                      [(ngModel)]="machine.currentLoadingHours"
                      [readonly]="isEditMode"
                    />
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-6 col-md-6">
                  <div class="form-content">
                    <input
                      name="serviceDate"
                      placeholder="Last service date"
                      class="form-control"
                      required=""
                      type="text"
                      [(ngModel)]="machine.lastService"
                      autocomplete="off"
                      bsDatepicker [bsConfig]="bsConfig"
                    />
                  </div>
                </div>
                <div class="col-sm-6 col-md-6">
                  <div class="form-content">
                    <input
                      name="serviceHours"
                      placeholder="Last service hours"
                      class="form-control"
                      required=""
                      type="text"
                      [(ngModel)]="machine.lastServiceHours"
                    />
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-md-12">
                  <div class="form-message">
                    <textarea
                      class="field-element form-control"
                      data-gramm="true"
                      spellcheck="false"
                      data-gramm_editor="true"
                      name="msg"
                      placeholder="Message"
                      [(ngModel)]="machine.message"
                    ></textarea>
                  </div>
                  <button
                    type="submit"
                    name="submit"
                    class="sent-button arina-btn hvr-radial-out"
                    [disabled]="!machineForm.valid"
                  >
                    SAVE
                  </button>
                  <button
                    type="reset"
                    name="submit"
                    class="sent-button arina-btn hvr-radial-out"
                    (click)="reset()"
                  >
                    CLEAR
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-12" style="overflow-x: auto">
      <div class="row">
        <hr />
        <h2>Machine Lists</h2>
        <table
          class="table table-striped"
          [mfData]="machineList"
          #machineTable="mfDataTable"
          [mfRowsOnPage]="5"
        >
          <thead>
            <tr>
              <th><mfDefaultSorter by="name">Id</mfDefaultSorter></th>
              <th>
                <mfDefaultSorter by="email">Serial Number</mfDefaultSorter>
              </th>
              <th><mfDefaultSorter by="age">Make</mfDefaultSorter></th>
              <th><mfDefaultSorter by="age">Model</mfDefaultSorter></th>
              <th>
                <mfDefaultSorter by="age">Current running hrs</mfDefaultSorter>
              </th>
              <th>
                <mfDefaultSorter by="age">Current loading hrs</mfDefaultSorter>
              </th>
              <th>
                <mfDefaultSorter by="age">Last service date</mfDefaultSorter>
              </th>
              <th>
                <mfDefaultSorter by="age">Last service hours</mfDefaultSorter>
              </th>
              <th><mfDefaultSorter by="age">Action</mfDefaultSorter></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let machine of machineTable.data">
              <td>{{ machine.id }}</td>
              <td>{{ machine.machineSerialNo }}</td>
              <td>{{ machine.machineMake }}</td>
              <td>{{ machine.machineModel }}</td>
              <td>{{ machine.currentRunningHours }}</td>
              <td>{{ machine.currentLoadingHours }}</td>
              <td>{{ machine.lastService | date }}</td>
              <td>{{ machine.lastServiceHours }}</td>
              <td>
                <a
                  class="fa fa-edit"
                  (click)="editMachine(machine)"
                  style="cursor: pointer"
                ></a>
                <app-fileupload [machineId]="machine.id" (uploadedJobCardEvent)="uploadedJobCard($event)"></app-fileupload>
                <a class="fa fa-refresh fa-spin" (click)="getMachineJobCard(machine.id)" style="cursor: pointer; font-size:14px"></a>
              </td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <td colspan="4">
                <mfBootstrapPaginator
                  [rowsOnPageSet]="[5, 10, 25]"
                ></mfBootstrapPaginator>
              </td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  </div>
</section>
